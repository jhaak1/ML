{"cells":[{"source":"<a href=\"https://www.kaggle.com/code/jeremyhaakenson/generalized-additive-model-to-predict-flooding?scriptVersionId=285330664\" target=\"_blank\"><img align=\"left\" alt=\"Kaggle\" title=\"Open in Kaggle\" src=\"https://kaggle.com/static/images/open-in-kaggle.svg\"></a>","metadata":{},"cell_type":"markdown"},{"cell_type":"markdown","id":"0cf5ef3a","metadata":{"papermill":{"duration":0.002733,"end_time":"2025-12-11T03:04:46.092028","exception":false,"start_time":"2025-12-11T03:04:46.089295","status":"completed"},"tags":[]},"source":["In this notebook, I will use a generalized additive model to predict flooding."]},{"cell_type":"markdown","id":"6a699223","metadata":{"papermill":{"duration":0.002078,"end_time":"2025-12-11T03:04:46.096446","exception":false,"start_time":"2025-12-11T03:04:46.094368","status":"completed"},"tags":[]},"source":["# GAM"]},{"cell_type":"markdown","id":"bd6bf6aa","metadata":{"papermill":{"duration":0.002072,"end_time":"2025-12-11T03:04:46.100583","exception":false,"start_time":"2025-12-11T03:04:46.098511","status":"completed"},"tags":[]},"source":["Load the necessary packages."]},{"cell_type":"code","execution_count":1,"id":"c82dca71","metadata":{"execution":{"iopub.execute_input":"2025-12-11T03:04:46.109487Z","iopub.status.busy":"2025-12-11T03:04:46.107275Z","iopub.status.idle":"2025-12-11T03:04:46.347812Z","shell.execute_reply":"2025-12-11T03:04:46.345909Z"},"papermill":{"duration":0.248184,"end_time":"2025-12-11T03:04:46.350786","exception":false,"start_time":"2025-12-11T03:04:46.102602","status":"completed"},"tags":[]},"outputs":[{"name":"stderr","output_type":"stream","text":["Loading required package: splines\n","\n","Loading required package: foreach\n","\n","Loaded gam 1.22-3\n","\n","\n"]}],"source":["library(gam)"]},{"cell_type":"markdown","id":"49f3dc87","metadata":{"papermill":{"duration":0.002284,"end_time":"2025-12-11T03:04:46.355617","exception":false,"start_time":"2025-12-11T03:04:46.353333","status":"completed"},"tags":[]},"source":["Read in the data."]},{"cell_type":"code","execution_count":2,"id":"2381db2b","metadata":{"execution":{"iopub.execute_input":"2025-12-11T03:04:46.396781Z","iopub.status.busy":"2025-12-11T03:04:46.362328Z","iopub.status.idle":"2025-12-11T03:05:00.720069Z","shell.execute_reply":"2025-12-11T03:05:00.718026Z"},"papermill":{"duration":14.365219,"end_time":"2025-12-11T03:05:00.723317","exception":false,"start_time":"2025-12-11T03:04:46.358098","status":"completed"},"tags":[]},"outputs":[],"source":["train = read.csv('/kaggle/input/playground-series-s4e5/train.csv')\n","test = read.csv('/kaggle/input/playground-series-s4e5/test.csv')"]},{"cell_type":"markdown","id":"7937924b","metadata":{"papermill":{"duration":0.002645,"end_time":"2025-12-11T03:05:00.728596","exception":false,"start_time":"2025-12-11T03:05:00.725951","status":"completed"},"tags":[]},"source":["Add the feature suggested by @ambrosm, which is the sum of all of the original features."]},{"cell_type":"code","execution_count":3,"id":"a6117c39","metadata":{"execution":{"iopub.execute_input":"2025-12-11T03:05:00.737568Z","iopub.status.busy":"2025-12-11T03:05:00.735806Z","iopub.status.idle":"2025-12-11T03:05:00.978262Z","shell.execute_reply":"2025-12-11T03:05:00.97652Z"},"papermill":{"duration":0.249723,"end_time":"2025-12-11T03:05:00.980737","exception":false,"start_time":"2025-12-11T03:05:00.731014","status":"completed"},"tags":[]},"outputs":[],"source":["train$allsum = rowSums(train[2:21])\n","test$allsum = rowSums(test[2:21])"]},{"cell_type":"markdown","id":"32a5c58a","metadata":{"papermill":{"duration":0.00253,"end_time":"2025-12-11T03:05:00.985817","exception":false,"start_time":"2025-12-11T03:05:00.983287","status":"completed"},"tags":[]},"source":["Make the generalized additive model."]},{"cell_type":"code","execution_count":4,"id":"15acde59","metadata":{"execution":{"iopub.execute_input":"2025-12-11T03:05:00.994314Z","iopub.status.busy":"2025-12-11T03:05:00.992732Z","iopub.status.idle":"2025-12-11T03:06:22.173494Z","shell.execute_reply":"2025-12-11T03:06:22.171642Z"},"papermill":{"duration":81.188327,"end_time":"2025-12-11T03:06:22.176585","exception":false,"start_time":"2025-12-11T03:05:00.988258","status":"completed"},"tags":[]},"outputs":[],"source":["gam4 = gam(FloodProbability ~ (. -id)^2, data = train)\n","gam4.pred = suppressWarnings(predict(gam4, test))\n","gam4.sub = cbind.data.frame(test[1], gam4.pred)\n","colnames(gam4.sub)[2] = 'FloodProbability'\n","write.csv(gam4.sub, 'submission.csv', row.names = F)"]},{"cell_type":"markdown","id":"113b5efc","metadata":{"papermill":{"duration":0.002455,"end_time":"2025-12-11T03:06:22.181708","exception":false,"start_time":"2025-12-11T03:06:22.179253","status":"completed"},"tags":[]},"source":["This was pretty quick and easy.  This model might not perform as well as a neural network with this data, but I think it will be an important part of my final ensemble."]}],"metadata":{"kaggle":{"accelerator":"none","dataSources":[{"databundleVersionId":8121328,"sourceId":73278,"sourceType":"competition"}],"dockerImageVersionId":30618,"isGpuEnabled":false,"isInternetEnabled":true,"language":"r","sourceType":"notebook"},"kernelspec":{"display_name":"R","language":"R","name":"ir"},"language_info":{"codemirror_mode":"r","file_extension":".r","mimetype":"text/x-r-source","name":"R","pygments_lexer":"r","version":"4.0.5"},"papermill":{"default_parameters":{},"duration":100.117221,"end_time":"2025-12-11T03:06:22.708835","environment_variables":{},"exception":null,"input_path":"__notebook__.ipynb","output_path":"__notebook__.ipynb","parameters":{},"start_time":"2025-12-11T03:04:42.591614","version":"2.5.0"}},"nbformat":4,"nbformat_minor":5}