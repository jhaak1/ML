{"cells":[{"source":"<a href=\"https://www.kaggle.com/code/jeremyhaakenson/generalized-additive-model-to-predict-flooding?scriptVersionId=285330186\" target=\"_blank\"><img align=\"left\" alt=\"Kaggle\" title=\"Open in Kaggle\" src=\"https://kaggle.com/static/images/open-in-kaggle.svg\"></a>","metadata":{},"cell_type":"markdown"},{"cell_type":"markdown","id":"921987fc","metadata":{"papermill":{"duration":0.003117,"end_time":"2025-12-11T03:00:26.735217","exception":false,"start_time":"2025-12-11T03:00:26.7321","status":"completed"},"tags":[]},"source":["In this notebook, I will use a generalized additive model to predict flooding."]},{"cell_type":"markdown","id":"5197f6f4","metadata":{"papermill":{"duration":0.002228,"end_time":"2025-12-11T03:00:26.740101","exception":false,"start_time":"2025-12-11T03:00:26.737873","status":"completed"},"tags":[]},"source":["# GAM"]},{"cell_type":"markdown","id":"64ef86d8","metadata":{"papermill":{"duration":0.00208,"end_time":"2025-12-11T03:00:26.744364","exception":false,"start_time":"2025-12-11T03:00:26.742284","status":"completed"},"tags":[]},"source":["Load the necessary packages."]},{"cell_type":"code","execution_count":1,"id":"20777ade","metadata":{"execution":{"iopub.execute_input":"2025-12-11T03:00:26.753772Z","iopub.status.busy":"2025-12-11T03:00:26.751315Z","iopub.status.idle":"2025-12-11T03:00:27.013316Z","shell.execute_reply":"2025-12-11T03:00:27.011408Z"},"papermill":{"duration":0.269641,"end_time":"2025-12-11T03:00:27.016103","exception":false,"start_time":"2025-12-11T03:00:26.746462","status":"completed"},"tags":[]},"outputs":[{"name":"stderr","output_type":"stream","text":["Loading required package: splines\n","\n","Loading required package: foreach\n","\n","Loaded gam 1.22-3\n","\n","\n"]}],"source":["library(gam)"]},{"cell_type":"markdown","id":"babcb6b4","metadata":{"papermill":{"duration":0.00254,"end_time":"2025-12-11T03:00:27.02125","exception":false,"start_time":"2025-12-11T03:00:27.01871","status":"completed"},"tags":[]},"source":["Read in the data."]},{"cell_type":"code","execution_count":2,"id":"39edc82d","metadata":{"execution":{"iopub.execute_input":"2025-12-11T03:00:27.063791Z","iopub.status.busy":"2025-12-11T03:00:27.028725Z","iopub.status.idle":"2025-12-11T03:00:41.525223Z","shell.execute_reply":"2025-12-11T03:00:41.523438Z"},"papermill":{"duration":14.503389,"end_time":"2025-12-11T03:00:41.527531","exception":false,"start_time":"2025-12-11T03:00:27.024142","status":"completed"},"tags":[]},"outputs":[],"source":["train = read.csv('/kaggle/input/playground-series-s4e5/train.csv')\n","test = read.csv('/kaggle/input/playground-series-s4e5/test.csv')"]},{"cell_type":"markdown","id":"4375a2e7","metadata":{"papermill":{"duration":0.002696,"end_time":"2025-12-11T03:00:41.532919","exception":false,"start_time":"2025-12-11T03:00:41.530223","status":"completed"},"tags":[]},"source":["Add the feature suggested by @ambrosm, which is the sum of all of the original features."]},{"cell_type":"code","execution_count":3,"id":"a44a94de","metadata":{"execution":{"iopub.execute_input":"2025-12-11T03:00:41.5419Z","iopub.status.busy":"2025-12-11T03:00:41.539882Z","iopub.status.idle":"2025-12-11T03:00:41.801419Z","shell.execute_reply":"2025-12-11T03:00:41.799073Z"},"papermill":{"duration":0.269213,"end_time":"2025-12-11T03:00:41.804536","exception":false,"start_time":"2025-12-11T03:00:41.535323","status":"completed"},"tags":[]},"outputs":[],"source":["train$allsum = rowSums(train[2:21])\n","test$allsum = rowSums(test[2:21])"]},{"cell_type":"markdown","id":"c7e0fb44","metadata":{"papermill":{"duration":0.002896,"end_time":"2025-12-11T03:00:41.810199","exception":false,"start_time":"2025-12-11T03:00:41.807303","status":"completed"},"tags":[]},"source":["Make the generalized additive model."]},{"cell_type":"code","execution_count":4,"id":"d3b58e1b","metadata":{"execution":{"iopub.execute_input":"2025-12-11T03:00:41.823383Z","iopub.status.busy":"2025-12-11T03:00:41.820799Z","iopub.status.idle":"2025-12-11T03:02:06.974888Z","shell.execute_reply":"2025-12-11T03:02:06.973086Z"},"papermill":{"duration":85.164238,"end_time":"2025-12-11T03:02:06.97814","exception":false,"start_time":"2025-12-11T03:00:41.813902","status":"completed"},"tags":[]},"outputs":[],"source":["gam4 = gam(FloodProbability ~ (. -id)^2, data = train)\n","gam4.pred = suppressWarnings(predict(gam4, test))\n","gam4.sub = cbind.data.frame(test[1], gam4.pred)\n","colnames(gam4.sub)[2] = 'FloodProbability'\n","write.csv(gam4.sub, 'submission.csv', row.names = F)"]},{"cell_type":"markdown","id":"20e4a011","metadata":{"papermill":{"duration":0.002531,"end_time":"2025-12-11T03:02:06.983382","exception":false,"start_time":"2025-12-11T03:02:06.980851","status":"completed"},"tags":[]},"source":["This was pretty quick and easy.  This model might not perform as well as a neural network with this data, but I think it will be an important part of my final ensemble."]}],"metadata":{"kaggle":{"accelerator":"none","dataSources":[{"databundleVersionId":8121328,"sourceId":73278,"sourceType":"competition"}],"dockerImageVersionId":30618,"isGpuEnabled":false,"isInternetEnabled":true,"language":"r","sourceType":"notebook"},"kernelspec":{"display_name":"R","language":"R","name":"ir"},"language_info":{"codemirror_mode":"r","file_extension":".r","mimetype":"text/x-r-source","name":"R","pygments_lexer":"r","version":"4.0.5"},"papermill":{"default_parameters":{},"duration":104.370825,"end_time":"2025-12-11T03:02:07.50942","environment_variables":{},"exception":null,"input_path":"__notebook__.ipynb","output_path":"__notebook__.ipynb","parameters":{},"start_time":"2025-12-11T03:00:23.138595","version":"2.5.0"}},"nbformat":4,"nbformat_minor":5}