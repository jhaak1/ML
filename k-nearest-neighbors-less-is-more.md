{"cells":[{"source":"<a href=\"https://www.kaggle.com/code/jeremyhaakenson/k-nearest-neighbors-less-is-more?scriptVersionId=284384512\" target=\"_blank\"><img align=\"left\" alt=\"Kaggle\" title=\"Open in Kaggle\" src=\"https://kaggle.com/static/images/open-in-kaggle.svg\"></a>","metadata":{},"cell_type":"markdown"},{"cell_type":"markdown","id":"26137fdd","metadata":{"papermill":{"duration":0.004846,"end_time":"2025-12-07T02:33:32.797818","exception":false,"start_time":"2025-12-07T02:33:32.792972","status":"completed"},"tags":[]},"source":["In this notebook, I will attempt to improve the provided data by imputing all of the 0s using k-nearest neighbors."]},{"cell_type":"markdown","id":"05711292","metadata":{"papermill":{"duration":0.003708,"end_time":"2025-12-07T02:33:32.805361","exception":false,"start_time":"2025-12-07T02:33:32.801653","status":"completed"},"tags":[]},"source":[]},{"cell_type":"markdown","id":"71b6f326","metadata":{"papermill":{"duration":0.003632,"end_time":"2025-12-07T02:33:32.812834","exception":false,"start_time":"2025-12-07T02:33:32.809202","status":"completed"},"tags":[]},"source":["First, I will load the necessary packages."]},{"cell_type":"code","execution_count":1,"id":"4298f3f5","metadata":{"execution":{"iopub.execute_input":"2025-12-07T02:33:32.824238Z","iopub.status.busy":"2025-12-07T02:33:32.82218Z","iopub.status.idle":"2025-12-07T02:33:33.931709Z","shell.execute_reply":"2025-12-07T02:33:33.929594Z"},"papermill":{"duration":1.118582,"end_time":"2025-12-07T02:33:33.935029","exception":false,"start_time":"2025-12-07T02:33:32.816447","status":"completed"},"tags":[]},"outputs":[{"name":"stderr","output_type":"stream","text":["\n","Attaching package: ‘dplyr’\n","\n","\n","The following objects are masked from ‘package:stats’:\n","\n","    filter, lag\n","\n","\n","The following objects are masked from ‘package:base’:\n","\n","    intersect, setdiff, setequal, union\n","\n","\n","Registered S3 method overwritten by 'quantmod':\n","  method            from\n","  as.zoo.data.frame zoo \n","\n"]}],"source":["library(skimr)\n","library(dplyr)\n","library(DMwR2)"]},{"cell_type":"markdown","id":"27419795","metadata":{"papermill":{"duration":0.003943,"end_time":"2025-12-07T02:33:33.942853","exception":false,"start_time":"2025-12-07T02:33:33.93891","status":"completed"},"tags":[]},"source":["Next, I willl read in the sample submission file."]},{"cell_type":"code","execution_count":2,"id":"6af61c10","metadata":{"execution":{"iopub.execute_input":"2025-12-07T02:33:33.993005Z","iopub.status.busy":"2025-12-07T02:33:33.952994Z","iopub.status.idle":"2025-12-07T02:33:34.08028Z","shell.execute_reply":"2025-12-07T02:33:34.078155Z"},"papermill":{"duration":0.136751,"end_time":"2025-12-07T02:33:34.084159","exception":false,"start_time":"2025-12-07T02:33:33.947408","status":"completed"},"tags":[]},"outputs":[],"source":["train = read.csv('/kaggle/input/playground-series-s3e21/sample_submission.csv')"]},{"cell_type":"markdown","id":"c1ce5f79","metadata":{"papermill":{"duration":0.003468,"end_time":"2025-12-07T02:33:34.093063","exception":false,"start_time":"2025-12-07T02:33:34.089595","status":"completed"},"tags":[]},"source":["Then, I will look at the data using the skim() function."]},{"cell_type":"code","execution_count":3,"id":"c9b1f8c3","metadata":{"execution":{"iopub.execute_input":"2025-12-07T02:33:34.106733Z","iopub.status.busy":"2025-12-07T02:33:34.103434Z","iopub.status.idle":"2025-12-07T02:33:34.121579Z","shell.execute_reply":"2025-12-07T02:33:34.119555Z"},"papermill":{"duration":0.027879,"end_time":"2025-12-07T02:33:34.124472","exception":false,"start_time":"2025-12-07T02:33:34.096593","status":"completed"},"tags":[]},"outputs":[],"source":["#skim(train)"]},{"cell_type":"markdown","id":"ec2ca79d","metadata":{"papermill":{"duration":0.003383,"end_time":"2025-12-07T02:33:34.131476","exception":false,"start_time":"2025-12-07T02:33:34.128093","status":"completed"},"tags":[]},"source":["There are no missing values, but there are 0s that need to be imputed.\n","\n","NO2_4 has a minimum of -4, which appears to be an outlier.\n","\n","Many of the features appear to be right-skewed."]},{"cell_type":"markdown","id":"721530b4","metadata":{"papermill":{"duration":0.00359,"end_time":"2025-12-07T02:33:34.138549","exception":false,"start_time":"2025-12-07T02:33:34.134959","status":"completed"},"tags":[]},"source":["Next, I will slice off the first two columns (id and target).  These can be added back later."]},{"cell_type":"code","execution_count":4,"id":"10d98e5a","metadata":{"execution":{"iopub.execute_input":"2025-12-07T02:33:34.150433Z","iopub.status.busy":"2025-12-07T02:33:34.148428Z","iopub.status.idle":"2025-12-07T02:33:34.166588Z","shell.execute_reply":"2025-12-07T02:33:34.163923Z"},"papermill":{"duration":0.02755,"end_time":"2025-12-07T02:33:34.16967","exception":false,"start_time":"2025-12-07T02:33:34.14212","status":"completed"},"tags":[]},"outputs":[],"source":["train.work = train[3:37]"]},{"cell_type":"markdown","id":"3d8fc742","metadata":{"papermill":{"duration":0.003561,"end_time":"2025-12-07T02:33:34.17685","exception":false,"start_time":"2025-12-07T02:33:34.173289","status":"completed"},"tags":[]},"source":["Now I will replace 0s with NA, so that these values can be imputed."]},{"cell_type":"code","execution_count":5,"id":"135031f6","metadata":{"execution":{"iopub.execute_input":"2025-12-07T02:33:34.18884Z","iopub.status.busy":"2025-12-07T02:33:34.186616Z","iopub.status.idle":"2025-12-07T02:33:34.21016Z","shell.execute_reply":"2025-12-07T02:33:34.208059Z"},"papermill":{"duration":0.033186,"end_time":"2025-12-07T02:33:34.213766","exception":false,"start_time":"2025-12-07T02:33:34.18058","status":"completed"},"tags":[]},"outputs":[],"source":["train.work[train.work == 0] <- NA"]},{"cell_type":"markdown","id":"93901e7c","metadata":{"papermill":{"duration":0.003816,"end_time":"2025-12-07T02:33:34.221529","exception":false,"start_time":"2025-12-07T02:33:34.217713","status":"completed"},"tags":[]},"source":["Next, I will impute NAs (previously 0s) using k-nearest neighbors."]},{"cell_type":"code","execution_count":6,"id":"b5f29f06","metadata":{"execution":{"iopub.execute_input":"2025-12-07T02:33:34.233637Z","iopub.status.busy":"2025-12-07T02:33:34.231617Z","iopub.status.idle":"2025-12-07T02:33:34.532927Z","shell.execute_reply":"2025-12-07T02:33:34.528845Z"},"papermill":{"duration":0.313592,"end_time":"2025-12-07T02:33:34.538967","exception":false,"start_time":"2025-12-07T02:33:34.225375","status":"completed"},"tags":[]},"outputs":[],"source":["knn7 = knnImputation(train.work, k = 7)\n","\n","#skim(knn7)"]},{"cell_type":"markdown","id":"02ba674f","metadata":{"papermill":{"duration":0.010094,"end_time":"2025-12-07T02:33:34.559102","exception":false,"start_time":"2025-12-07T02:33:34.549008","status":"completed"},"tags":[]},"source":["The minimum for NO2_4 looks like an outlier.  I will replace this value with .1 (the next lowest value)."]},{"cell_type":"code","execution_count":7,"id":"8b7d54af","metadata":{"execution":{"iopub.execute_input":"2025-12-07T02:33:34.591219Z","iopub.status.busy":"2025-12-07T02:33:34.585173Z","iopub.status.idle":"2025-12-07T02:33:34.628234Z","shell.execute_reply":"2025-12-07T02:33:34.621864Z"},"papermill":{"duration":0.063045,"end_time":"2025-12-07T02:33:34.633814","exception":false,"start_time":"2025-12-07T02:33:34.570769","status":"completed"},"tags":[]},"outputs":[],"source":["knn7$NO2_4[3167] = .1\n","#skim(knn7)"]},{"cell_type":"markdown","id":"56fcdeff","metadata":{"papermill":{"duration":0.00374,"end_time":"2025-12-07T02:33:34.647132","exception":false,"start_time":"2025-12-07T02:33:34.643392","status":"completed"},"tags":[]},"source":["Finally, I will add the id and target columns back, round to three decimal places, and submit."]},{"cell_type":"code","execution_count":8,"id":"214c92e7","metadata":{"execution":{"iopub.execute_input":"2025-12-07T02:33:34.657491Z","iopub.status.busy":"2025-12-07T02:33:34.6559Z","iopub.status.idle":"2025-12-07T02:33:34.828737Z","shell.execute_reply":"2025-12-07T02:33:34.826858Z"},"papermill":{"duration":0.180925,"end_time":"2025-12-07T02:33:34.831525","exception":false,"start_time":"2025-12-07T02:33:34.6506","status":"completed"},"tags":[]},"outputs":[],"source":["write.csv(cbind.data.frame(train[1:2], round(knn7, 3)), 'submission.csv', row.names = F)"]}],"metadata":{"kaggle":{"accelerator":"none","dataSources":[{"databundleVersionId":6388931,"sourceId":59109,"sourceType":"competition"}],"dockerImageVersionId":30530,"isGpuEnabled":false,"isInternetEnabled":true,"language":"r","sourceType":"notebook"},"kernelspec":{"display_name":"R","language":"R","name":"ir"},"language_info":{"codemirror_mode":"r","file_extension":".r","mimetype":"text/x-r-source","name":"R","pygments_lexer":"r","version":"4.0.5"},"papermill":{"default_parameters":{},"duration":6.248219,"end_time":"2025-12-07T02:33:34.957266","environment_variables":{},"exception":null,"input_path":"__notebook__.ipynb","output_path":"__notebook__.ipynb","parameters":{},"start_time":"2025-12-07T02:33:28.709047","version":"2.4.0"}},"nbformat":4,"nbformat_minor":5}