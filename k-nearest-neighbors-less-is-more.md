{"cells":[{"source":"<a href=\"https://www.kaggle.com/code/jeremyhaakenson/k-nearest-neighbors-less-is-more?scriptVersionId=285041952\" target=\"_blank\"><img align=\"left\" alt=\"Kaggle\" title=\"Open in Kaggle\" src=\"https://kaggle.com/static/images/open-in-kaggle.svg\"></a>","metadata":{},"cell_type":"markdown"},{"cell_type":"markdown","id":"757b76a3","metadata":{"papermill":{"duration":0.004924,"end_time":"2025-12-09T22:29:20.419739","exception":false,"start_time":"2025-12-09T22:29:20.414815","status":"completed"},"tags":[]},"source":["In this notebook, I will attempt to improve the provided data by imputing all of the 0s using k-nearest neighbors."]},{"cell_type":"markdown","id":"bea718e1","metadata":{"papermill":{"duration":0.003248,"end_time":"2025-12-09T22:29:20.426432","exception":false,"start_time":"2025-12-09T22:29:20.423184","status":"completed"},"tags":[]},"source":[]},{"cell_type":"markdown","id":"d4461b0b","metadata":{"papermill":{"duration":0.003203,"end_time":"2025-12-09T22:29:20.432893","exception":false,"start_time":"2025-12-09T22:29:20.42969","status":"completed"},"tags":[]},"source":["First, I will load the necessary packages."]},{"cell_type":"code","execution_count":1,"id":"cb66dee9","metadata":{"execution":{"iopub.execute_input":"2025-12-09T22:29:20.443404Z","iopub.status.busy":"2025-12-09T22:29:20.44126Z","iopub.status.idle":"2025-12-09T22:29:21.360718Z","shell.execute_reply":"2025-12-09T22:29:21.358806Z"},"papermill":{"duration":0.927866,"end_time":"2025-12-09T22:29:21.363969","exception":false,"start_time":"2025-12-09T22:29:20.436103","status":"completed"},"tags":[]},"outputs":[{"name":"stderr","output_type":"stream","text":["\n","Attaching package: ‘dplyr’\n","\n","\n","The following objects are masked from ‘package:stats’:\n","\n","    filter, lag\n","\n","\n","The following objects are masked from ‘package:base’:\n","\n","    intersect, setdiff, setequal, union\n","\n","\n","Registered S3 method overwritten by 'quantmod':\n","  method            from\n","  as.zoo.data.frame zoo \n","\n"]}],"source":["library(skimr)\n","library(dplyr)\n","library(DMwR2)"]},{"cell_type":"markdown","id":"1199005f","metadata":{"papermill":{"duration":0.00352,"end_time":"2025-12-09T22:29:21.371692","exception":false,"start_time":"2025-12-09T22:29:21.368172","status":"completed"},"tags":[]},"source":["Next, I willl read in the sample submission file."]},{"cell_type":"code","execution_count":2,"id":"915f781c","metadata":{"execution":{"iopub.execute_input":"2025-12-09T22:29:21.422146Z","iopub.status.busy":"2025-12-09T22:29:21.380754Z","iopub.status.idle":"2025-12-09T22:29:21.515754Z","shell.execute_reply":"2025-12-09T22:29:21.513453Z"},"papermill":{"duration":0.144111,"end_time":"2025-12-09T22:29:21.519183","exception":false,"start_time":"2025-12-09T22:29:21.375072","status":"completed"},"tags":[]},"outputs":[],"source":["train = read.csv('/kaggle/input/playground-series-s3e21/sample_submission.csv')"]},{"cell_type":"markdown","id":"b26229e7","metadata":{"papermill":{"duration":0.003405,"end_time":"2025-12-09T22:29:21.527622","exception":false,"start_time":"2025-12-09T22:29:21.524217","status":"completed"},"tags":[]},"source":["Then, I will look at the data using the skim() function."]},{"cell_type":"code","execution_count":3,"id":"cc0402bd","metadata":{"execution":{"iopub.execute_input":"2025-12-09T22:29:21.53895Z","iopub.status.busy":"2025-12-09T22:29:21.536885Z","iopub.status.idle":"2025-12-09T22:29:21.552494Z","shell.execute_reply":"2025-12-09T22:29:21.549879Z"},"papermill":{"duration":0.024179,"end_time":"2025-12-09T22:29:21.555218","exception":false,"start_time":"2025-12-09T22:29:21.531039","status":"completed"},"tags":[]},"outputs":[],"source":["#skim(train)"]},{"cell_type":"markdown","id":"c46f5fae","metadata":{"papermill":{"duration":0.003411,"end_time":"2025-12-09T22:29:21.562266","exception":false,"start_time":"2025-12-09T22:29:21.558855","status":"completed"},"tags":[]},"source":["There are no missing values, but there are 0s that need to be imputed.\n","\n","NO2_4 has a minimum of -4, which appears to be an outlier.\n","\n","Many of the features appear to be right-skewed."]},{"cell_type":"markdown","id":"4eba9bd7","metadata":{"papermill":{"duration":0.003375,"end_time":"2025-12-09T22:29:21.568981","exception":false,"start_time":"2025-12-09T22:29:21.565606","status":"completed"},"tags":[]},"source":["Next, I will slice off the first two columns (id and target).  These can be added back later."]},{"cell_type":"code","execution_count":4,"id":"ab8df5dc","metadata":{"execution":{"iopub.execute_input":"2025-12-09T22:29:21.579974Z","iopub.status.busy":"2025-12-09T22:29:21.578035Z","iopub.status.idle":"2025-12-09T22:29:21.595107Z","shell.execute_reply":"2025-12-09T22:29:21.592927Z"},"papermill":{"duration":0.025343,"end_time":"2025-12-09T22:29:21.597718","exception":false,"start_time":"2025-12-09T22:29:21.572375","status":"completed"},"tags":[]},"outputs":[],"source":["train.work = train[3:37]"]},{"cell_type":"markdown","id":"5b69521a","metadata":{"papermill":{"duration":0.003446,"end_time":"2025-12-09T22:29:21.604638","exception":false,"start_time":"2025-12-09T22:29:21.601192","status":"completed"},"tags":[]},"source":["Now I will replace 0s with NA, so that these values can be imputed."]},{"cell_type":"code","execution_count":5,"id":"cfaa43a1","metadata":{"execution":{"iopub.execute_input":"2025-12-09T22:29:21.616433Z","iopub.status.busy":"2025-12-09T22:29:21.613767Z","iopub.status.idle":"2025-12-09T22:29:21.637956Z","shell.execute_reply":"2025-12-09T22:29:21.635948Z"},"papermill":{"duration":0.032677,"end_time":"2025-12-09T22:29:21.64074","exception":false,"start_time":"2025-12-09T22:29:21.608063","status":"completed"},"tags":[]},"outputs":[],"source":["train.work[train.work == 0] <- NA"]},{"cell_type":"markdown","id":"90ec00e1","metadata":{"papermill":{"duration":0.003529,"end_time":"2025-12-09T22:29:21.647783","exception":false,"start_time":"2025-12-09T22:29:21.644254","status":"completed"},"tags":[]},"source":["Next, I will impute NAs (previously 0s) using k-nearest neighbors."]},{"cell_type":"code","execution_count":6,"id":"84e3a20a","metadata":{"execution":{"iopub.execute_input":"2025-12-09T22:29:21.660018Z","iopub.status.busy":"2025-12-09T22:29:21.65755Z","iopub.status.idle":"2025-12-09T22:29:21.950801Z","shell.execute_reply":"2025-12-09T22:29:21.94684Z"},"papermill":{"duration":0.306305,"end_time":"2025-12-09T22:29:21.957491","exception":false,"start_time":"2025-12-09T22:29:21.651186","status":"completed"},"tags":[]},"outputs":[],"source":["knn7 = knnImputation(train.work, k = 7)\n","\n","#skim(knn7)"]},{"cell_type":"markdown","id":"eea0040d","metadata":{"papermill":{"duration":0.012232,"end_time":"2025-12-09T22:29:21.981073","exception":false,"start_time":"2025-12-09T22:29:21.968841","status":"completed"},"tags":[]},"source":["The minimum for NO2_4 looks like an outlier.  I will replace this value with .1 (the next lowest value)."]},{"cell_type":"code","execution_count":7,"id":"054f8075","metadata":{"execution":{"iopub.execute_input":"2025-12-09T22:29:22.011946Z","iopub.status.busy":"2025-12-09T22:29:22.005828Z","iopub.status.idle":"2025-12-09T22:29:22.047926Z","shell.execute_reply":"2025-12-09T22:29:22.041661Z"},"papermill":{"duration":0.061564,"end_time":"2025-12-09T22:29:22.053413","exception":false,"start_time":"2025-12-09T22:29:21.991849","status":"completed"},"tags":[]},"outputs":[],"source":["knn7$NO2_4[3167] = .1\n","#skim(knn7)"]},{"cell_type":"markdown","id":"72fb438f","metadata":{"papermill":{"duration":0.003519,"end_time":"2025-12-09T22:29:22.065278","exception":false,"start_time":"2025-12-09T22:29:22.061759","status":"completed"},"tags":[]},"source":["Finally, I will add the id and target columns back, round to three decimal places, and submit."]},{"cell_type":"code","execution_count":8,"id":"531c5313","metadata":{"execution":{"iopub.execute_input":"2025-12-09T22:29:22.075633Z","iopub.status.busy":"2025-12-09T22:29:22.073951Z","iopub.status.idle":"2025-12-09T22:29:22.248884Z","shell.execute_reply":"2025-12-09T22:29:22.247044Z"},"papermill":{"duration":0.183327,"end_time":"2025-12-09T22:29:22.252003","exception":false,"start_time":"2025-12-09T22:29:22.068676","status":"completed"},"tags":[]},"outputs":[],"source":["write.csv(cbind.data.frame(train[1:2], round(knn7, 3)), 'submission.csv', row.names = F)"]}],"metadata":{"kaggle":{"accelerator":"none","dataSources":[{"databundleVersionId":6388931,"sourceId":59109,"sourceType":"competition"}],"dockerImageVersionId":30530,"isGpuEnabled":false,"isInternetEnabled":true,"language":"r","sourceType":"notebook"},"kernelspec":{"display_name":"R","language":"R","name":"ir"},"language_info":{"codemirror_mode":"r","file_extension":".r","mimetype":"text/x-r-source","name":"R","pygments_lexer":"r","version":"4.0.5"},"papermill":{"default_parameters":{},"duration":5.467622,"end_time":"2025-12-09T22:29:22.37877","environment_variables":{},"exception":null,"input_path":"__notebook__.ipynb","output_path":"__notebook__.ipynb","parameters":{},"start_time":"2025-12-09T22:29:16.911148","version":"2.4.0"}},"nbformat":4,"nbformat_minor":5}
