{"cells":[{"source":"<a href=\"https://www.kaggle.com/code/jeremyhaakenson/k-nearest-neighbors-less-is-more?scriptVersionId=285329752\" target=\"_blank\"><img align=\"left\" alt=\"Kaggle\" title=\"Open in Kaggle\" src=\"https://kaggle.com/static/images/open-in-kaggle.svg\"></a>","metadata":{},"cell_type":"markdown"},{"cell_type":"markdown","id":"eac9855f","metadata":{"papermill":{"duration":0.004546,"end_time":"2025-12-11T02:56:33.452436","exception":false,"start_time":"2025-12-11T02:56:33.44789","status":"completed"},"tags":[]},"source":["In this notebook, I will attempt to improve the provided data by imputing all of the 0s using k-nearest neighbors."]},{"cell_type":"markdown","id":"eb568618","metadata":{"papermill":{"duration":0.003292,"end_time":"2025-12-11T02:56:33.459358","exception":false,"start_time":"2025-12-11T02:56:33.456066","status":"completed"},"tags":[]},"source":[]},{"cell_type":"markdown","id":"6537d865","metadata":{"papermill":{"duration":0.003066,"end_time":"2025-12-11T02:56:33.465555","exception":false,"start_time":"2025-12-11T02:56:33.462489","status":"completed"},"tags":[]},"source":["First, I will load the necessary packages."]},{"cell_type":"code","execution_count":1,"id":"7da16f6a","metadata":{"execution":{"iopub.execute_input":"2025-12-11T02:56:33.475513Z","iopub.status.busy":"2025-12-11T02:56:33.473431Z","iopub.status.idle":"2025-12-11T02:56:34.298106Z","shell.execute_reply":"2025-12-11T02:56:34.296384Z"},"papermill":{"duration":0.831787,"end_time":"2025-12-11T02:56:34.300344","exception":false,"start_time":"2025-12-11T02:56:33.468557","status":"completed"},"tags":[]},"outputs":[{"name":"stderr","output_type":"stream","text":["\n","Attaching package: ‘dplyr’\n","\n","\n","The following objects are masked from ‘package:stats’:\n","\n","    filter, lag\n","\n","\n","The following objects are masked from ‘package:base’:\n","\n","    intersect, setdiff, setequal, union\n","\n","\n","Registered S3 method overwritten by 'quantmod':\n","  method            from\n","  as.zoo.data.frame zoo \n","\n"]}],"source":["library(skimr)\n","library(dplyr)\n","library(DMwR2)"]},{"cell_type":"markdown","id":"ce3c1dac","metadata":{"papermill":{"duration":0.003171,"end_time":"2025-12-11T02:56:34.307116","exception":false,"start_time":"2025-12-11T02:56:34.303945","status":"completed"},"tags":[]},"source":["Next, I willl read in the sample submission file."]},{"cell_type":"code","execution_count":2,"id":"2cf34f08","metadata":{"execution":{"iopub.execute_input":"2025-12-11T02:56:34.35303Z","iopub.status.busy":"2025-12-11T02:56:34.315225Z","iopub.status.idle":"2025-12-11T02:56:34.437132Z","shell.execute_reply":"2025-12-11T02:56:34.435107Z"},"papermill":{"duration":0.129393,"end_time":"2025-12-11T02:56:34.439658","exception":false,"start_time":"2025-12-11T02:56:34.310265","status":"completed"},"tags":[]},"outputs":[],"source":["train = read.csv('/kaggle/input/playground-series-s3e21/sample_submission.csv')"]},{"cell_type":"markdown","id":"0930dccc","metadata":{"papermill":{"duration":0.0032,"end_time":"2025-12-11T02:56:34.447554","exception":false,"start_time":"2025-12-11T02:56:34.444354","status":"completed"},"tags":[]},"source":["Then, I will look at the data using the skim() function."]},{"cell_type":"code","execution_count":3,"id":"42fd9e70","metadata":{"execution":{"iopub.execute_input":"2025-12-11T02:56:34.458417Z","iopub.status.busy":"2025-12-11T02:56:34.455977Z","iopub.status.idle":"2025-12-11T02:56:34.470381Z","shell.execute_reply":"2025-12-11T02:56:34.46849Z"},"papermill":{"duration":0.022091,"end_time":"2025-12-11T02:56:34.472799","exception":false,"start_time":"2025-12-11T02:56:34.450708","status":"completed"},"tags":[]},"outputs":[],"source":["#skim(train)"]},{"cell_type":"markdown","id":"ce113bde","metadata":{"papermill":{"duration":0.003233,"end_time":"2025-12-11T02:56:34.479447","exception":false,"start_time":"2025-12-11T02:56:34.476214","status":"completed"},"tags":[]},"source":["There are no missing values, but there are 0s that need to be imputed.\n","\n","NO2_4 has a minimum of -4, which appears to be an outlier.\n","\n","Many of the features appear to be right-skewed."]},{"cell_type":"markdown","id":"5d1940e2","metadata":{"papermill":{"duration":0.003153,"end_time":"2025-12-11T02:56:34.485756","exception":false,"start_time":"2025-12-11T02:56:34.482603","status":"completed"},"tags":[]},"source":["Next, I will slice off the first two columns (id and target).  These can be added back later."]},{"cell_type":"code","execution_count":4,"id":"26c49f6a","metadata":{"execution":{"iopub.execute_input":"2025-12-11T02:56:34.496398Z","iopub.status.busy":"2025-12-11T02:56:34.494554Z","iopub.status.idle":"2025-12-11T02:56:34.510742Z","shell.execute_reply":"2025-12-11T02:56:34.508286Z"},"papermill":{"duration":0.024224,"end_time":"2025-12-11T02:56:34.513184","exception":false,"start_time":"2025-12-11T02:56:34.48896","status":"completed"},"tags":[]},"outputs":[],"source":["train.work = train[3:37]"]},{"cell_type":"markdown","id":"ddfb1bb7","metadata":{"papermill":{"duration":0.003267,"end_time":"2025-12-11T02:56:34.520059","exception":false,"start_time":"2025-12-11T02:56:34.516792","status":"completed"},"tags":[]},"source":["Now I will replace 0s with NA, so that these values can be imputed."]},{"cell_type":"code","execution_count":5,"id":"cae77eb9","metadata":{"execution":{"iopub.execute_input":"2025-12-11T02:56:34.530302Z","iopub.status.busy":"2025-12-11T02:56:34.528449Z","iopub.status.idle":"2025-12-11T02:56:34.54921Z","shell.execute_reply":"2025-12-11T02:56:34.547271Z"},"papermill":{"duration":0.028983,"end_time":"2025-12-11T02:56:34.552277","exception":false,"start_time":"2025-12-11T02:56:34.523294","status":"completed"},"tags":[]},"outputs":[],"source":["train.work[train.work == 0] <- NA"]},{"cell_type":"markdown","id":"4731a93c","metadata":{"papermill":{"duration":0.003259,"end_time":"2025-12-11T02:56:34.558879","exception":false,"start_time":"2025-12-11T02:56:34.55562","status":"completed"},"tags":[]},"source":["Next, I will impute NAs (previously 0s) using k-nearest neighbors."]},{"cell_type":"code","execution_count":6,"id":"41745f28","metadata":{"execution":{"iopub.execute_input":"2025-12-11T02:56:34.569358Z","iopub.status.busy":"2025-12-11T02:56:34.567504Z","iopub.status.idle":"2025-12-11T02:56:34.800628Z","shell.execute_reply":"2025-12-11T02:56:34.797876Z"},"papermill":{"duration":0.243562,"end_time":"2025-12-11T02:56:34.805588","exception":false,"start_time":"2025-12-11T02:56:34.562026","status":"completed"},"tags":[]},"outputs":[],"source":["knn7 = knnImputation(train.work, k = 7)\n","\n","#skim(knn7)"]},{"cell_type":"markdown","id":"0384865e","metadata":{"papermill":{"duration":0.006202,"end_time":"2025-12-11T02:56:34.817908","exception":false,"start_time":"2025-12-11T02:56:34.811706","status":"completed"},"tags":[]},"source":["The minimum for NO2_4 looks like an outlier.  I will replace this value with .1 (the next lowest value)."]},{"cell_type":"code","execution_count":7,"id":"301a4b80","metadata":{"execution":{"iopub.execute_input":"2025-12-11T02:56:34.83727Z","iopub.status.busy":"2025-12-11T02:56:34.83304Z","iopub.status.idle":"2025-12-11T02:56:34.863862Z","shell.execute_reply":"2025-12-11T02:56:34.859246Z"},"papermill":{"duration":0.043834,"end_time":"2025-12-11T02:56:34.86783","exception":false,"start_time":"2025-12-11T02:56:34.823996","status":"completed"},"tags":[]},"outputs":[],"source":["knn7$NO2_4[3167] = .1\n","#skim(knn7)"]},{"cell_type":"markdown","id":"4c1f05d8","metadata":{"papermill":{"duration":0.006322,"end_time":"2025-12-11T02:56:34.880679","exception":false,"start_time":"2025-12-11T02:56:34.874357","status":"completed"},"tags":[]},"source":["Finally, I will add the id and target columns back, round to three decimal places, and submit."]},{"cell_type":"code","execution_count":8,"id":"269248ba","metadata":{"execution":{"iopub.execute_input":"2025-12-11T02:56:34.90037Z","iopub.status.busy":"2025-12-11T02:56:34.895506Z","iopub.status.idle":"2025-12-11T02:56:35.074367Z","shell.execute_reply":"2025-12-11T02:56:35.072571Z"},"papermill":{"duration":0.190008,"end_time":"2025-12-11T02:56:35.076778","exception":false,"start_time":"2025-12-11T02:56:34.88677","status":"completed"},"tags":[]},"outputs":[],"source":["write.csv(cbind.data.frame(train[1:2], round(knn7, 3)), 'submission.csv', row.names = F)"]}],"metadata":{"kaggle":{"accelerator":"none","dataSources":[{"databundleVersionId":6388931,"sourceId":59109,"sourceType":"competition"}],"dockerImageVersionId":30530,"isGpuEnabled":false,"isInternetEnabled":true,"language":"r","sourceType":"notebook"},"kernelspec":{"display_name":"R","language":"R","name":"ir"},"language_info":{"codemirror_mode":"r","file_extension":".r","mimetype":"text/x-r-source","name":"R","pygments_lexer":"r","version":"4.0.5"},"papermill":{"default_parameters":{},"duration":4.911138,"end_time":"2025-12-11T02:56:35.200527","environment_variables":{},"exception":null,"input_path":"__notebook__.ipynb","output_path":"__notebook__.ipynb","parameters":{},"start_time":"2025-12-11T02:56:30.289389","version":"2.4.0"}},"nbformat":4,"nbformat_minor":5}