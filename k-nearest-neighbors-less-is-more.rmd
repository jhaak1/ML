{"cells":[{"source":"<a href=\"https://www.kaggle.com/code/jeremyhaakenson/k-nearest-neighbors-less-is-more?scriptVersionId=284384644\" target=\"_blank\"><img align=\"left\" alt=\"Kaggle\" title=\"Open in Kaggle\" src=\"https://kaggle.com/static/images/open-in-kaggle.svg\"></a>","metadata":{},"cell_type":"markdown"},{"cell_type":"markdown","id":"5d09de3a","metadata":{"papermill":{"duration":0.004922,"end_time":"2025-12-07T02:34:58.882763","exception":false,"start_time":"2025-12-07T02:34:58.877841","status":"completed"},"tags":[]},"source":["In this notebook, I will attempt to improve the provided data by imputing all of the 0s using k-nearest neighbors."]},{"cell_type":"markdown","id":"1893f991","metadata":{"papermill":{"duration":0.003445,"end_time":"2025-12-07T02:34:58.890283","exception":false,"start_time":"2025-12-07T02:34:58.886838","status":"completed"},"tags":[]},"source":[]},{"cell_type":"markdown","id":"99757fb4","metadata":{"papermill":{"duration":0.003354,"end_time":"2025-12-07T02:34:58.897036","exception":false,"start_time":"2025-12-07T02:34:58.893682","status":"completed"},"tags":[]},"source":["First, I will load the necessary packages."]},{"cell_type":"code","execution_count":1,"id":"398d107d","metadata":{"execution":{"iopub.execute_input":"2025-12-07T02:34:58.909569Z","iopub.status.busy":"2025-12-07T02:34:58.906555Z","iopub.status.idle":"2025-12-07T02:35:00.257431Z","shell.execute_reply":"2025-12-07T02:35:00.255532Z"},"papermill":{"duration":1.35956,"end_time":"2025-12-07T02:35:00.259943","exception":false,"start_time":"2025-12-07T02:34:58.900383","status":"completed"},"tags":[]},"outputs":[{"name":"stderr","output_type":"stream","text":["\n","Attaching package: ‘dplyr’\n","\n","\n","The following objects are masked from ‘package:stats’:\n","\n","    filter, lag\n","\n","\n","The following objects are masked from ‘package:base’:\n","\n","    intersect, setdiff, setequal, union\n","\n","\n","Registered S3 method overwritten by 'quantmod':\n","  method            from\n","  as.zoo.data.frame zoo \n","\n"]}],"source":["library(skimr)\n","library(dplyr)\n","library(DMwR2)"]},{"cell_type":"markdown","id":"32d8f334","metadata":{"papermill":{"duration":0.003582,"end_time":"2025-12-07T02:35:00.26759","exception":false,"start_time":"2025-12-07T02:35:00.264008","status":"completed"},"tags":[]},"source":["Next, I willl read in the sample submission file."]},{"cell_type":"code","execution_count":2,"id":"07c6dca6","metadata":{"execution":{"iopub.execute_input":"2025-12-07T02:35:00.316705Z","iopub.status.busy":"2025-12-07T02:35:00.276778Z","iopub.status.idle":"2025-12-07T02:35:00.4108Z","shell.execute_reply":"2025-12-07T02:35:00.408617Z"},"papermill":{"duration":0.142607,"end_time":"2025-12-07T02:35:00.413874","exception":false,"start_time":"2025-12-07T02:35:00.271267","status":"completed"},"tags":[]},"outputs":[],"source":["train = read.csv('/kaggle/input/playground-series-s3e21/sample_submission.csv')"]},{"cell_type":"markdown","id":"ba5e10ef","metadata":{"papermill":{"duration":0.004095,"end_time":"2025-12-07T02:35:00.423379","exception":false,"start_time":"2025-12-07T02:35:00.419284","status":"completed"},"tags":[]},"source":["Then, I will look at the data using the skim() function."]},{"cell_type":"code","execution_count":3,"id":"e64581c7","metadata":{"execution":{"iopub.execute_input":"2025-12-07T02:35:00.435855Z","iopub.status.busy":"2025-12-07T02:35:00.433521Z","iopub.status.idle":"2025-12-07T02:35:00.448771Z","shell.execute_reply":"2025-12-07T02:35:00.446669Z"},"papermill":{"duration":0.023997,"end_time":"2025-12-07T02:35:00.451532","exception":false,"start_time":"2025-12-07T02:35:00.427535","status":"completed"},"tags":[]},"outputs":[],"source":["#skim(train)"]},{"cell_type":"markdown","id":"619d371d","metadata":{"papermill":{"duration":0.003565,"end_time":"2025-12-07T02:35:00.458965","exception":false,"start_time":"2025-12-07T02:35:00.4554","status":"completed"},"tags":[]},"source":["There are no missing values, but there are 0s that need to be imputed.\n","\n","NO2_4 has a minimum of -4, which appears to be an outlier.\n","\n","Many of the features appear to be right-skewed."]},{"cell_type":"markdown","id":"6f338976","metadata":{"papermill":{"duration":0.003532,"end_time":"2025-12-07T02:35:00.466106","exception":false,"start_time":"2025-12-07T02:35:00.462574","status":"completed"},"tags":[]},"source":["Next, I will slice off the first two columns (id and target).  These can be added back later."]},{"cell_type":"code","execution_count":4,"id":"de60a689","metadata":{"execution":{"iopub.execute_input":"2025-12-07T02:35:00.477873Z","iopub.status.busy":"2025-12-07T02:35:00.475469Z","iopub.status.idle":"2025-12-07T02:35:00.493473Z","shell.execute_reply":"2025-12-07T02:35:00.491299Z"},"papermill":{"duration":0.026815,"end_time":"2025-12-07T02:35:00.49657","exception":false,"start_time":"2025-12-07T02:35:00.469755","status":"completed"},"tags":[]},"outputs":[],"source":["train.work = train[3:37]"]},{"cell_type":"markdown","id":"d634b77c","metadata":{"papermill":{"duration":0.003638,"end_time":"2025-12-07T02:35:00.503988","exception":false,"start_time":"2025-12-07T02:35:00.50035","status":"completed"},"tags":[]},"source":["Now I will replace 0s with NA, so that these values can be imputed."]},{"cell_type":"code","execution_count":5,"id":"943b0ed1","metadata":{"execution":{"iopub.execute_input":"2025-12-07T02:35:00.515458Z","iopub.status.busy":"2025-12-07T02:35:00.513462Z","iopub.status.idle":"2025-12-07T02:35:00.536594Z","shell.execute_reply":"2025-12-07T02:35:00.534417Z"},"papermill":{"duration":0.032001,"end_time":"2025-12-07T02:35:00.539751","exception":false,"start_time":"2025-12-07T02:35:00.50775","status":"completed"},"tags":[]},"outputs":[],"source":["train.work[train.work == 0] <- NA"]},{"cell_type":"markdown","id":"79631c5c","metadata":{"papermill":{"duration":0.003666,"end_time":"2025-12-07T02:35:00.547193","exception":false,"start_time":"2025-12-07T02:35:00.543527","status":"completed"},"tags":[]},"source":["Next, I will impute NAs (previously 0s) using k-nearest neighbors."]},{"cell_type":"code","execution_count":6,"id":"7a0d6c65","metadata":{"execution":{"iopub.execute_input":"2025-12-07T02:35:00.558759Z","iopub.status.busy":"2025-12-07T02:35:00.556761Z","iopub.status.idle":"2025-12-07T02:35:00.769269Z","shell.execute_reply":"2025-12-07T02:35:00.766772Z"},"papermill":{"duration":0.221877,"end_time":"2025-12-07T02:35:00.772729","exception":false,"start_time":"2025-12-07T02:35:00.550852","status":"completed"},"tags":[]},"outputs":[],"source":["knn7 = knnImputation(train.work, k = 7)\n","\n","#skim(knn7)"]},{"cell_type":"markdown","id":"156303bf","metadata":{"papermill":{"duration":0.005667,"end_time":"2025-12-07T02:35:00.784284","exception":false,"start_time":"2025-12-07T02:35:00.778617","status":"completed"},"tags":[]},"source":["The minimum for NO2_4 looks like an outlier.  I will replace this value with .1 (the next lowest value)."]},{"cell_type":"code","execution_count":7,"id":"1cf277d8","metadata":{"execution":{"iopub.execute_input":"2025-12-07T02:35:00.800739Z","iopub.status.busy":"2025-12-07T02:35:00.798504Z","iopub.status.idle":"2025-12-07T02:35:00.825276Z","shell.execute_reply":"2025-12-07T02:35:00.821172Z"},"papermill":{"duration":0.038906,"end_time":"2025-12-07T02:35:00.828803","exception":false,"start_time":"2025-12-07T02:35:00.789897","status":"completed"},"tags":[]},"outputs":[],"source":["knn7$NO2_4[3167] = .1\n","#skim(knn7)"]},{"cell_type":"markdown","id":"3a85f667","metadata":{"papermill":{"duration":0.005773,"end_time":"2025-12-07T02:35:00.840603","exception":false,"start_time":"2025-12-07T02:35:00.83483","status":"completed"},"tags":[]},"source":["Finally, I will add the id and target columns back, round to three decimal places, and submit."]},{"cell_type":"code","execution_count":8,"id":"72a0562c","metadata":{"execution":{"iopub.execute_input":"2025-12-07T02:35:00.858512Z","iopub.status.busy":"2025-12-07T02:35:00.854238Z","iopub.status.idle":"2025-12-07T02:35:01.067054Z","shell.execute_reply":"2025-12-07T02:35:01.065217Z"},"papermill":{"duration":0.223495,"end_time":"2025-12-07T02:35:01.069817","exception":false,"start_time":"2025-12-07T02:35:00.846322","status":"completed"},"tags":[]},"outputs":[],"source":["write.csv(cbind.data.frame(train[1:2], round(knn7, 3)), 'submission.csv', row.names = F)"]}],"metadata":{"kaggle":{"accelerator":"none","dataSources":[{"databundleVersionId":6388931,"sourceId":59109,"sourceType":"competition"}],"dockerImageVersionId":30530,"isGpuEnabled":false,"isInternetEnabled":true,"language":"r","sourceType":"notebook"},"kernelspec":{"display_name":"R","language":"R","name":"ir"},"language_info":{"codemirror_mode":"r","file_extension":".r","mimetype":"text/x-r-source","name":"R","pygments_lexer":"r","version":"4.0.5"},"papermill":{"default_parameters":{},"duration":7.322554,"end_time":"2025-12-07T02:35:01.195204","environment_variables":{},"exception":null,"input_path":"__notebook__.ipynb","output_path":"__notebook__.ipynb","parameters":{},"start_time":"2025-12-07T02:34:53.87265","version":"2.4.0"}},"nbformat":4,"nbformat_minor":5}