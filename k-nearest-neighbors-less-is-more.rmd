{"cells":[{"source":"<a href=\"https://www.kaggle.com/code/jeremyhaakenson/k-nearest-neighbors-less-is-more?scriptVersionId=285328838\" target=\"_blank\"><img align=\"left\" alt=\"Kaggle\" title=\"Open in Kaggle\" src=\"https://kaggle.com/static/images/open-in-kaggle.svg\"></a>","metadata":{},"cell_type":"markdown"},{"cell_type":"markdown","id":"a76e8ee5","metadata":{"papermill":{"duration":0.004722,"end_time":"2025-12-11T02:48:57.157556","exception":false,"start_time":"2025-12-11T02:48:57.152834","status":"completed"},"tags":[]},"source":["In this notebook, I will attempt to improve the provided data by imputing all of the 0s using k-nearest neighbors."]},{"cell_type":"markdown","id":"22e604b2","metadata":{"papermill":{"duration":0.00507,"end_time":"2025-12-11T02:48:57.166163","exception":false,"start_time":"2025-12-11T02:48:57.161093","status":"completed"},"tags":[]},"source":[]},{"cell_type":"markdown","id":"6afb48fb","metadata":{"papermill":{"duration":0.003715,"end_time":"2025-12-11T02:48:57.173323","exception":false,"start_time":"2025-12-11T02:48:57.169608","status":"completed"},"tags":[]},"source":["First, I will load the necessary packages."]},{"cell_type":"code","execution_count":1,"id":"6c4c0058","metadata":{"execution":{"iopub.execute_input":"2025-12-11T02:48:57.184993Z","iopub.status.busy":"2025-12-11T02:48:57.182843Z","iopub.status.idle":"2025-12-11T02:48:58.111947Z","shell.execute_reply":"2025-12-11T02:48:58.110021Z"},"papermill":{"duration":0.937724,"end_time":"2025-12-11T02:48:58.114861","exception":false,"start_time":"2025-12-11T02:48:57.177137","status":"completed"},"tags":[]},"outputs":[{"name":"stderr","output_type":"stream","text":["\n","Attaching package: ‘dplyr’\n","\n","\n","The following objects are masked from ‘package:stats’:\n","\n","    filter, lag\n","\n","\n","The following objects are masked from ‘package:base’:\n","\n","    intersect, setdiff, setequal, union\n","\n","\n","Registered S3 method overwritten by 'quantmod':\n","  method            from\n","  as.zoo.data.frame zoo \n","\n"]}],"source":["library(skimr)\n","library(dplyr)\n","library(DMwR2)"]},{"cell_type":"markdown","id":"b22ad7da","metadata":{"papermill":{"duration":0.00359,"end_time":"2025-12-11T02:48:58.122285","exception":false,"start_time":"2025-12-11T02:48:58.118695","status":"completed"},"tags":[]},"source":["Next, I willl read in the sample submission file."]},{"cell_type":"code","execution_count":2,"id":"5190550e","metadata":{"execution":{"iopub.execute_input":"2025-12-11T02:48:58.174247Z","iopub.status.busy":"2025-12-11T02:48:58.131465Z","iopub.status.idle":"2025-12-11T02:48:58.27199Z","shell.execute_reply":"2025-12-11T02:48:58.269249Z"},"papermill":{"duration":0.149082,"end_time":"2025-12-11T02:48:58.274975","exception":false,"start_time":"2025-12-11T02:48:58.125893","status":"completed"},"tags":[]},"outputs":[],"source":["train = read.csv('/kaggle/input/playground-series-s3e21/sample_submission.csv')"]},{"cell_type":"markdown","id":"23728eb3","metadata":{"papermill":{"duration":0.003425,"end_time":"2025-12-11T02:48:58.283441","exception":false,"start_time":"2025-12-11T02:48:58.280016","status":"completed"},"tags":[]},"source":["Then, I will look at the data using the skim() function."]},{"cell_type":"code","execution_count":3,"id":"0a51eb23","metadata":{"execution":{"iopub.execute_input":"2025-12-11T02:48:58.294906Z","iopub.status.busy":"2025-12-11T02:48:58.292857Z","iopub.status.idle":"2025-12-11T02:48:58.308454Z","shell.execute_reply":"2025-12-11T02:48:58.306318Z"},"papermill":{"duration":0.024262,"end_time":"2025-12-11T02:48:58.311318","exception":false,"start_time":"2025-12-11T02:48:58.287056","status":"completed"},"tags":[]},"outputs":[],"source":["#skim(train)"]},{"cell_type":"markdown","id":"9c33a00e","metadata":{"papermill":{"duration":0.003577,"end_time":"2025-12-11T02:48:58.318627","exception":false,"start_time":"2025-12-11T02:48:58.31505","status":"completed"},"tags":[]},"source":["There are no missing values, but there are 0s that need to be imputed.\n","\n","NO2_4 has a minimum of -4, which appears to be an outlier.\n","\n","Many of the features appear to be right-skewed."]},{"cell_type":"markdown","id":"486a1aed","metadata":{"papermill":{"duration":0.003604,"end_time":"2025-12-11T02:48:58.3258","exception":false,"start_time":"2025-12-11T02:48:58.322196","status":"completed"},"tags":[]},"source":["Next, I will slice off the first two columns (id and target).  These can be added back later."]},{"cell_type":"code","execution_count":4,"id":"d99561a3","metadata":{"execution":{"iopub.execute_input":"2025-12-11T02:48:58.337229Z","iopub.status.busy":"2025-12-11T02:48:58.335237Z","iopub.status.idle":"2025-12-11T02:48:58.353039Z","shell.execute_reply":"2025-12-11T02:48:58.350853Z"},"papermill":{"duration":0.026558,"end_time":"2025-12-11T02:48:58.355978","exception":false,"start_time":"2025-12-11T02:48:58.32942","status":"completed"},"tags":[]},"outputs":[],"source":["train.work = train[3:37]"]},{"cell_type":"markdown","id":"0bc939a8","metadata":{"papermill":{"duration":0.003668,"end_time":"2025-12-11T02:48:58.363414","exception":false,"start_time":"2025-12-11T02:48:58.359746","status":"completed"},"tags":[]},"source":["Now I will replace 0s with NA, so that these values can be imputed."]},{"cell_type":"code","execution_count":5,"id":"bacfc6b5","metadata":{"execution":{"iopub.execute_input":"2025-12-11T02:48:58.376295Z","iopub.status.busy":"2025-12-11T02:48:58.373744Z","iopub.status.idle":"2025-12-11T02:48:58.397883Z","shell.execute_reply":"2025-12-11T02:48:58.395714Z"},"papermill":{"duration":0.033847,"end_time":"2025-12-11T02:48:58.400979","exception":false,"start_time":"2025-12-11T02:48:58.367132","status":"completed"},"tags":[]},"outputs":[],"source":["train.work[train.work == 0] <- NA"]},{"cell_type":"markdown","id":"030d51e5","metadata":{"papermill":{"duration":0.003865,"end_time":"2025-12-11T02:48:58.408739","exception":false,"start_time":"2025-12-11T02:48:58.404874","status":"completed"},"tags":[]},"source":["Next, I will impute NAs (previously 0s) using k-nearest neighbors."]},{"cell_type":"code","execution_count":6,"id":"70792221","metadata":{"execution":{"iopub.execute_input":"2025-12-11T02:48:58.421164Z","iopub.status.busy":"2025-12-11T02:48:58.418581Z","iopub.status.idle":"2025-12-11T02:48:58.682183Z","shell.execute_reply":"2025-12-11T02:48:58.679136Z"},"papermill":{"duration":0.274943,"end_time":"2025-12-11T02:48:58.687447","exception":false,"start_time":"2025-12-11T02:48:58.412504","status":"completed"},"tags":[]},"outputs":[],"source":["knn7 = knnImputation(train.work, k = 7)\n","\n","#skim(knn7)"]},{"cell_type":"markdown","id":"61d385b0","metadata":{"papermill":{"duration":0.006757,"end_time":"2025-12-11T02:48:58.700902","exception":false,"start_time":"2025-12-11T02:48:58.694145","status":"completed"},"tags":[]},"source":["The minimum for NO2_4 looks like an outlier.  I will replace this value with .1 (the next lowest value)."]},{"cell_type":"code","execution_count":7,"id":"bb32c9df","metadata":{"execution":{"iopub.execute_input":"2025-12-11T02:48:58.722056Z","iopub.status.busy":"2025-12-11T02:48:58.717525Z","iopub.status.idle":"2025-12-11T02:48:58.75072Z","shell.execute_reply":"2025-12-11T02:48:58.74582Z"},"papermill":{"duration":0.047468,"end_time":"2025-12-11T02:48:58.755049","exception":false,"start_time":"2025-12-11T02:48:58.707581","status":"completed"},"tags":[]},"outputs":[],"source":["knn7$NO2_4[3167] = .1\n","#skim(knn7)"]},{"cell_type":"markdown","id":"185a1a48","metadata":{"papermill":{"duration":0.006801,"end_time":"2025-12-11T02:48:58.768751","exception":false,"start_time":"2025-12-11T02:48:58.76195","status":"completed"},"tags":[]},"source":["Finally, I will add the id and target columns back, round to three decimal places, and submit."]},{"cell_type":"code","execution_count":8,"id":"1f55bf2a","metadata":{"execution":{"iopub.execute_input":"2025-12-11T02:48:58.790013Z","iopub.status.busy":"2025-12-11T02:48:58.784693Z","iopub.status.idle":"2025-12-11T02:48:58.967291Z","shell.execute_reply":"2025-12-11T02:48:58.965348Z"},"papermill":{"duration":0.194662,"end_time":"2025-12-11T02:48:58.969894","exception":false,"start_time":"2025-12-11T02:48:58.775232","status":"completed"},"tags":[]},"outputs":[],"source":["write.csv(cbind.data.frame(train[1:2], round(knn7, 3)), 'submission.csv', row.names = F)"]}],"metadata":{"kaggle":{"accelerator":"none","dataSources":[{"databundleVersionId":6388931,"sourceId":59109,"sourceType":"competition"}],"dockerImageVersionId":30530,"isGpuEnabled":false,"isInternetEnabled":true,"language":"r","sourceType":"notebook"},"kernelspec":{"display_name":"R","language":"R","name":"ir"},"language_info":{"codemirror_mode":"r","file_extension":".r","mimetype":"text/x-r-source","name":"R","pygments_lexer":"r","version":"4.0.5"},"papermill":{"default_parameters":{},"duration":5.490461,"end_time":"2025-12-11T02:48:59.096917","environment_variables":{},"exception":null,"input_path":"__notebook__.ipynb","output_path":"__notebook__.ipynb","parameters":{},"start_time":"2025-12-11T02:48:53.606456","version":"2.4.0"}},"nbformat":4,"nbformat_minor":5}