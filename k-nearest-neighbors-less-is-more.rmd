{"cells":[{"source":"<a href=\"https://www.kaggle.com/code/jeremyhaakenson/k-nearest-neighbors-less-is-more?scriptVersionId=285329442\" target=\"_blank\"><img align=\"left\" alt=\"Kaggle\" title=\"Open in Kaggle\" src=\"https://kaggle.com/static/images/open-in-kaggle.svg\"></a>","metadata":{},"cell_type":"markdown"},{"cell_type":"markdown","id":"e17ff5b8","metadata":{"papermill":{"duration":0.004472,"end_time":"2025-12-11T02:54:02.342108","exception":false,"start_time":"2025-12-11T02:54:02.337636","status":"completed"},"tags":[]},"source":["In this notebook, I will attempt to improve the provided data by imputing all of the 0s using k-nearest neighbors."]},{"cell_type":"markdown","id":"3c154118","metadata":{"papermill":{"duration":0.003241,"end_time":"2025-12-11T02:54:02.348788","exception":false,"start_time":"2025-12-11T02:54:02.345547","status":"completed"},"tags":[]},"source":[]},{"cell_type":"markdown","id":"b0238c5a","metadata":{"papermill":{"duration":0.003973,"end_time":"2025-12-11T02:54:02.356069","exception":false,"start_time":"2025-12-11T02:54:02.352096","status":"completed"},"tags":[]},"source":["First, I will load the necessary packages."]},{"cell_type":"code","execution_count":1,"id":"7fe553f2","metadata":{"execution":{"iopub.execute_input":"2025-12-11T02:54:02.366974Z","iopub.status.busy":"2025-12-11T02:54:02.364781Z","iopub.status.idle":"2025-12-11T02:54:03.379757Z","shell.execute_reply":"2025-12-11T02:54:03.377813Z"},"papermill":{"duration":1.02366,"end_time":"2025-12-11T02:54:03.383005","exception":false,"start_time":"2025-12-11T02:54:02.359345","status":"completed"},"tags":[]},"outputs":[{"name":"stderr","output_type":"stream","text":["\n","Attaching package: ‘dplyr’\n","\n","\n","The following objects are masked from ‘package:stats’:\n","\n","    filter, lag\n","\n","\n","The following objects are masked from ‘package:base’:\n","\n","    intersect, setdiff, setequal, union\n","\n","\n","Registered S3 method overwritten by 'quantmod':\n","  method            from\n","  as.zoo.data.frame zoo \n","\n"]}],"source":["library(skimr)\n","library(dplyr)\n","library(DMwR2)"]},{"cell_type":"markdown","id":"96565756","metadata":{"papermill":{"duration":0.003359,"end_time":"2025-12-11T02:54:03.390033","exception":false,"start_time":"2025-12-11T02:54:03.386674","status":"completed"},"tags":[]},"source":["Next, I willl read in the sample submission file."]},{"cell_type":"code","execution_count":2,"id":"80da73bc","metadata":{"execution":{"iopub.execute_input":"2025-12-11T02:54:03.438589Z","iopub.status.busy":"2025-12-11T02:54:03.398718Z","iopub.status.idle":"2025-12-11T02:54:03.549011Z","shell.execute_reply":"2025-12-11T02:54:03.546857Z"},"papermill":{"duration":0.159155,"end_time":"2025-12-11T02:54:03.552537","exception":false,"start_time":"2025-12-11T02:54:03.393382","status":"completed"},"tags":[]},"outputs":[],"source":["train = read.csv('/kaggle/input/playground-series-s3e21/sample_submission.csv')"]},{"cell_type":"markdown","id":"5892cbb9","metadata":{"papermill":{"duration":0.003314,"end_time":"2025-12-11T02:54:03.560822","exception":false,"start_time":"2025-12-11T02:54:03.557508","status":"completed"},"tags":[]},"source":["Then, I will look at the data using the skim() function."]},{"cell_type":"code","execution_count":3,"id":"395b3982","metadata":{"execution":{"iopub.execute_input":"2025-12-11T02:54:03.572225Z","iopub.status.busy":"2025-12-11T02:54:03.569788Z","iopub.status.idle":"2025-12-11T02:54:03.585907Z","shell.execute_reply":"2025-12-11T02:54:03.583913Z"},"papermill":{"duration":0.025025,"end_time":"2025-12-11T02:54:03.589264","exception":false,"start_time":"2025-12-11T02:54:03.564239","status":"completed"},"tags":[]},"outputs":[],"source":["#skim(train)"]},{"cell_type":"markdown","id":"dcdadfa7","metadata":{"papermill":{"duration":0.003592,"end_time":"2025-12-11T02:54:03.596411","exception":false,"start_time":"2025-12-11T02:54:03.592819","status":"completed"},"tags":[]},"source":["There are no missing values, but there are 0s that need to be imputed.\n","\n","NO2_4 has a minimum of -4, which appears to be an outlier.\n","\n","Many of the features appear to be right-skewed."]},{"cell_type":"markdown","id":"664a8812","metadata":{"papermill":{"duration":0.003456,"end_time":"2025-12-11T02:54:03.603428","exception":false,"start_time":"2025-12-11T02:54:03.599972","status":"completed"},"tags":[]},"source":["Next, I will slice off the first two columns (id and target).  These can be added back later."]},{"cell_type":"code","execution_count":4,"id":"77addf67","metadata":{"execution":{"iopub.execute_input":"2025-12-11T02:54:03.615006Z","iopub.status.busy":"2025-12-11T02:54:03.612573Z","iopub.status.idle":"2025-12-11T02:54:03.630969Z","shell.execute_reply":"2025-12-11T02:54:03.628915Z"},"papermill":{"duration":0.028201,"end_time":"2025-12-11T02:54:03.635103","exception":false,"start_time":"2025-12-11T02:54:03.606902","status":"completed"},"tags":[]},"outputs":[],"source":["train.work = train[3:37]"]},{"cell_type":"markdown","id":"275d5ea4","metadata":{"papermill":{"duration":0.003526,"end_time":"2025-12-11T02:54:03.642164","exception":false,"start_time":"2025-12-11T02:54:03.638638","status":"completed"},"tags":[]},"source":["Now I will replace 0s with NA, so that these values can be imputed."]},{"cell_type":"code","execution_count":5,"id":"2e63fa7a","metadata":{"execution":{"iopub.execute_input":"2025-12-11T02:54:03.653825Z","iopub.status.busy":"2025-12-11T02:54:03.651799Z","iopub.status.idle":"2025-12-11T02:54:03.676278Z","shell.execute_reply":"2025-12-11T02:54:03.673697Z"},"papermill":{"duration":0.035102,"end_time":"2025-12-11T02:54:03.680815","exception":false,"start_time":"2025-12-11T02:54:03.645713","status":"completed"},"tags":[]},"outputs":[],"source":["train.work[train.work == 0] <- NA"]},{"cell_type":"markdown","id":"cb8b71ab","metadata":{"papermill":{"duration":0.003656,"end_time":"2025-12-11T02:54:03.688047","exception":false,"start_time":"2025-12-11T02:54:03.684391","status":"completed"},"tags":[]},"source":["Next, I will impute NAs (previously 0s) using k-nearest neighbors."]},{"cell_type":"code","execution_count":6,"id":"0059749d","metadata":{"execution":{"iopub.execute_input":"2025-12-11T02:54:03.69947Z","iopub.status.busy":"2025-12-11T02:54:03.697501Z","iopub.status.idle":"2025-12-11T02:54:03.993219Z","shell.execute_reply":"2025-12-11T02:54:03.98923Z"},"papermill":{"duration":0.30735,"end_time":"2025-12-11T02:54:03.998923","exception":false,"start_time":"2025-12-11T02:54:03.691573","status":"completed"},"tags":[]},"outputs":[],"source":["knn7 = knnImputation(train.work, k = 7)\n","\n","#skim(knn7)"]},{"cell_type":"markdown","id":"4c0c9284","metadata":{"papermill":{"duration":0.009863,"end_time":"2025-12-11T02:54:04.01862","exception":false,"start_time":"2025-12-11T02:54:04.008757","status":"completed"},"tags":[]},"source":["The minimum for NO2_4 looks like an outlier.  I will replace this value with .1 (the next lowest value)."]},{"cell_type":"code","execution_count":7,"id":"6894aa4a","metadata":{"execution":{"iopub.execute_input":"2025-12-11T02:54:04.048319Z","iopub.status.busy":"2025-12-11T02:54:04.042552Z","iopub.status.idle":"2025-12-11T02:54:04.084547Z","shell.execute_reply":"2025-12-11T02:54:04.078297Z"},"papermill":{"duration":0.061624,"end_time":"2025-12-11T02:54:04.090202","exception":false,"start_time":"2025-12-11T02:54:04.028578","status":"completed"},"tags":[]},"outputs":[],"source":["knn7$NO2_4[3167] = .1\n","#skim(knn7)"]},{"cell_type":"markdown","id":"dcc6b90d","metadata":{"papermill":{"duration":0.005332,"end_time":"2025-12-11T02:54:04.105882","exception":false,"start_time":"2025-12-11T02:54:04.10055","status":"completed"},"tags":[]},"source":["Finally, I will add the id and target columns back, round to three decimal places, and submit."]},{"cell_type":"code","execution_count":8,"id":"c7ed2f55","metadata":{"execution":{"iopub.execute_input":"2025-12-11T02:54:04.116672Z","iopub.status.busy":"2025-12-11T02:54:04.11498Z","iopub.status.idle":"2025-12-11T02:54:04.291983Z","shell.execute_reply":"2025-12-11T02:54:04.2902Z"},"papermill":{"duration":0.184895,"end_time":"2025-12-11T02:54:04.294392","exception":false,"start_time":"2025-12-11T02:54:04.109497","status":"completed"},"tags":[]},"outputs":[],"source":["write.csv(cbind.data.frame(train[1:2], round(knn7, 3)), 'submission.csv', row.names = F)"]}],"metadata":{"kaggle":{"accelerator":"none","dataSources":[{"databundleVersionId":6388931,"sourceId":59109,"sourceType":"competition"}],"dockerImageVersionId":30530,"isGpuEnabled":false,"isInternetEnabled":true,"language":"r","sourceType":"notebook"},"kernelspec":{"display_name":"R","language":"R","name":"ir"},"language_info":{"codemirror_mode":"r","file_extension":".r","mimetype":"text/x-r-source","name":"R","pygments_lexer":"r","version":"4.0.5"},"papermill":{"default_parameters":{},"duration":5.848735,"end_time":"2025-12-11T02:54:04.418614","environment_variables":{},"exception":null,"input_path":"__notebook__.ipynb","output_path":"__notebook__.ipynb","parameters":{},"start_time":"2025-12-11T02:53:58.569879","version":"2.4.0"}},"nbformat":4,"nbformat_minor":5}