{"cells":[{"source":"<a href=\"https://www.kaggle.com/code/jeremyhaakenson/k-nearest-neighbors-less-is-more?scriptVersionId=283737778\" target=\"_blank\"><img align=\"left\" alt=\"Kaggle\" title=\"Open in Kaggle\" src=\"https://kaggle.com/static/images/open-in-kaggle.svg\"></a>","metadata":{},"cell_type":"markdown"},{"cell_type":"markdown","id":"3fa6e83c","metadata":{"papermill":{"duration":0.004345,"end_time":"2025-12-04T01:27:57.846396","exception":false,"start_time":"2025-12-04T01:27:57.842051","status":"completed"},"tags":[]},"source":["In this notebook, I will attempt to improve the provided data by imputing all of the 0s using k-nearest neighbors."]},{"cell_type":"markdown","id":"560ceb4f","metadata":{"papermill":{"duration":0.003103,"end_time":"2025-12-04T01:27:57.852822","exception":false,"start_time":"2025-12-04T01:27:57.849719","status":"completed"},"tags":[]},"source":["First, I will load the necessary packages."]},{"cell_type":"code","execution_count":1,"id":"4c6aaae6","metadata":{"execution":{"iopub.execute_input":"2025-12-04T01:27:57.864833Z","iopub.status.busy":"2025-12-04T01:27:57.862058Z","iopub.status.idle":"2025-12-04T01:27:59.032333Z","shell.execute_reply":"2025-12-04T01:27:59.030026Z"},"papermill":{"duration":1.179713,"end_time":"2025-12-04T01:27:59.035678","exception":false,"start_time":"2025-12-04T01:27:57.855965","status":"completed"},"tags":[]},"outputs":[{"name":"stderr","output_type":"stream","text":["\n","Attaching package: ‘dplyr’\n","\n","\n","The following objects are masked from ‘package:stats’:\n","\n","    filter, lag\n","\n","\n","The following objects are masked from ‘package:base’:\n","\n","    intersect, setdiff, setequal, union\n","\n","\n","Registered S3 method overwritten by 'quantmod':\n","  method            from\n","  as.zoo.data.frame zoo \n","\n"]}],"source":["library(skimr)\n","library(dplyr)\n","library(DMwR2)"]},{"cell_type":"markdown","id":"cf408690","metadata":{"papermill":{"duration":0.00353,"end_time":"2025-12-04T01:27:59.04335","exception":false,"start_time":"2025-12-04T01:27:59.03982","status":"completed"},"tags":[]},"source":["Next, I willl read in the sample submission file."]},{"cell_type":"code","execution_count":2,"id":"1ce5ffd6","metadata":{"execution":{"iopub.execute_input":"2025-12-04T01:27:59.097019Z","iopub.status.busy":"2025-12-04T01:27:59.052497Z","iopub.status.idle":"2025-12-04T01:27:59.186377Z","shell.execute_reply":"2025-12-04T01:27:59.183823Z"},"papermill":{"duration":0.144427,"end_time":"2025-12-04T01:27:59.191362","exception":false,"start_time":"2025-12-04T01:27:59.046935","status":"completed"},"tags":[]},"outputs":[],"source":["train = read.csv('/kaggle/input/playground-series-s3e21/sample_submission.csv')"]},{"cell_type":"markdown","id":"d4409719","metadata":{"papermill":{"duration":0.004749,"end_time":"2025-12-04T01:27:59.200355","exception":false,"start_time":"2025-12-04T01:27:59.195606","status":"completed"},"tags":[]},"source":["Then, I will look at the data using the skim() function."]},{"cell_type":"code","execution_count":3,"id":"fa5b9608","metadata":{"execution":{"iopub.execute_input":"2025-12-04T01:27:59.214201Z","iopub.status.busy":"2025-12-04T01:27:59.212221Z","iopub.status.idle":"2025-12-04T01:27:59.231074Z","shell.execute_reply":"2025-12-04T01:27:59.228656Z"},"papermill":{"duration":0.028678,"end_time":"2025-12-04T01:27:59.23496","exception":false,"start_time":"2025-12-04T01:27:59.206282","status":"completed"},"tags":[]},"outputs":[],"source":["#skim(train)"]},{"cell_type":"markdown","id":"9d02dbea","metadata":{"papermill":{"duration":0.003516,"end_time":"2025-12-04T01:27:59.242322","exception":false,"start_time":"2025-12-04T01:27:59.238806","status":"completed"},"tags":[]},"source":["There are no missing values, but there are 0s that need to be imputed.\n","\n","NO2_4 has a minimum of -4, which appears to be an outlier.\n","\n","Many of the features appear to be right-skewed."]},{"cell_type":"markdown","id":"8d4ed830","metadata":{"papermill":{"duration":0.003327,"end_time":"2025-12-04T01:27:59.249155","exception":false,"start_time":"2025-12-04T01:27:59.245828","status":"completed"},"tags":[]},"source":["Next, I will slice off the first two columns (id and target).  These can be added back later."]},{"cell_type":"code","execution_count":4,"id":"fd8f663b","metadata":{"execution":{"iopub.execute_input":"2025-12-04T01:27:59.260248Z","iopub.status.busy":"2025-12-04T01:27:59.258285Z","iopub.status.idle":"2025-12-04T01:27:59.274686Z","shell.execute_reply":"2025-12-04T01:27:59.272563Z"},"papermill":{"duration":0.024867,"end_time":"2025-12-04T01:27:59.277437","exception":false,"start_time":"2025-12-04T01:27:59.25257","status":"completed"},"tags":[]},"outputs":[],"source":["train.work = train[3:37]"]},{"cell_type":"markdown","id":"0f3420a3","metadata":{"papermill":{"duration":0.003527,"end_time":"2025-12-04T01:27:59.284916","exception":false,"start_time":"2025-12-04T01:27:59.281389","status":"completed"},"tags":[]},"source":["Now I will replace 0s with NA, so that these values can be imputed."]},{"cell_type":"code","execution_count":5,"id":"494e39d4","metadata":{"execution":{"iopub.execute_input":"2025-12-04T01:27:59.296242Z","iopub.status.busy":"2025-12-04T01:27:59.294258Z","iopub.status.idle":"2025-12-04T01:27:59.319545Z","shell.execute_reply":"2025-12-04T01:27:59.316817Z"},"papermill":{"duration":0.034072,"end_time":"2025-12-04T01:27:59.322578","exception":false,"start_time":"2025-12-04T01:27:59.288506","status":"completed"},"tags":[]},"outputs":[],"source":["train.work[train.work == 0] <- NA"]},{"cell_type":"markdown","id":"bd9eebfa","metadata":{"papermill":{"duration":0.00349,"end_time":"2025-12-04T01:27:59.329669","exception":false,"start_time":"2025-12-04T01:27:59.326179","status":"completed"},"tags":[]},"source":["Next, I will impute NAs (previously 0s) using k-nearest neighbors."]},{"cell_type":"code","execution_count":6,"id":"631ecbcf","metadata":{"execution":{"iopub.execute_input":"2025-12-04T01:27:59.340887Z","iopub.status.busy":"2025-12-04T01:27:59.338948Z","iopub.status.idle":"2025-12-04T01:27:59.610677Z","shell.execute_reply":"2025-12-04T01:27:59.607513Z"},"papermill":{"duration":0.28187,"end_time":"2025-12-04T01:27:59.61509","exception":false,"start_time":"2025-12-04T01:27:59.33322","status":"completed"},"tags":[]},"outputs":[],"source":["knn7 = knnImputation(train.work, k = 7)\n","\n","#skim(knn7)"]},{"cell_type":"markdown","id":"495009dd","metadata":{"papermill":{"duration":0.007089,"end_time":"2025-12-04T01:27:59.630474","exception":false,"start_time":"2025-12-04T01:27:59.623385","status":"completed"},"tags":[]},"source":["The minimum for NO2_4 looks like an outlier.  I will replace this value with .1 (the next lowest value)."]},{"cell_type":"code","execution_count":7,"id":"33475f0f","metadata":{"execution":{"iopub.execute_input":"2025-12-04T01:27:59.650631Z","iopub.status.busy":"2025-12-04T01:27:59.645921Z","iopub.status.idle":"2025-12-04T01:27:59.683693Z","shell.execute_reply":"2025-12-04T01:27:59.677311Z"},"papermill":{"duration":0.051879,"end_time":"2025-12-04T01:27:59.688751","exception":false,"start_time":"2025-12-04T01:27:59.636872","status":"completed"},"tags":[]},"outputs":[],"source":["knn7$NO2_4[3167] = .1\n","#skim(knn7)"]},{"cell_type":"markdown","id":"47ecff09","metadata":{"papermill":{"duration":0.007289,"end_time":"2025-12-04T01:27:59.702624","exception":false,"start_time":"2025-12-04T01:27:59.695335","status":"completed"},"tags":[]},"source":["Finally, I will add the id and target columns back, round to three decimal places, and submit."]},{"cell_type":"code","execution_count":8,"id":"2e0b8c87","metadata":{"execution":{"iopub.execute_input":"2025-12-04T01:27:59.723295Z","iopub.status.busy":"2025-12-04T01:27:59.721191Z","iopub.status.idle":"2025-12-04T01:27:59.911943Z","shell.execute_reply":"2025-12-04T01:27:59.910019Z"},"papermill":{"duration":0.205649,"end_time":"2025-12-04T01:27:59.915256","exception":false,"start_time":"2025-12-04T01:27:59.709607","status":"completed"},"tags":[]},"outputs":[],"source":["write.csv(cbind.data.frame(train[1:2], round(knn7, 3)), 'submission.csv', row.names = F)"]}],"metadata":{"kaggle":{"accelerator":"none","dataSources":[{"databundleVersionId":6388931,"sourceId":59109,"sourceType":"competition"}],"dockerImageVersionId":30530,"isGpuEnabled":false,"isInternetEnabled":true,"language":"r","sourceType":"notebook"},"kernelspec":{"display_name":"R","language":"R","name":"ir"},"language_info":{"codemirror_mode":"r","file_extension":".r","mimetype":"text/x-r-source","name":"R","pygments_lexer":"r","version":"4.0.5"},"papermill":{"default_parameters":{},"duration":6.482879,"end_time":"2025-12-04T01:28:00.042151","environment_variables":{},"exception":null,"input_path":"__notebook__.ipynb","output_path":"__notebook__.ipynb","parameters":{},"start_time":"2025-12-04T01:27:53.559272","version":"2.4.0"}},"nbformat":4,"nbformat_minor":5}